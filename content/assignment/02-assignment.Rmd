---
title: "Applying ggplot2 to Real Data"
linktitle: "2: Visualization II"
publishDate: "2021-01-29"
output:
  blogdown::html_page:
    toc: true
menu:
  assignment:
    parent: Labs
    weight: 2
type: docs
weight: 1
editor_options:
  chunk_output_type: console
---

:::fyi

**NOTE**

You must turn in a PDF document of your `R Markdown` code. Submit this to D2L by 11:59 PM Eastern Time on Monday, Feb 8th.

:::

## Preliminaries
As always, we will first have to load ``ggplot2``. To do this, we will load the tidyverse by running this code:

```
library(tidyverse)
```

## Background

The New York City Department of Buildings (DOB) maintains a list of construction sites that have been categorized as "essential" during the city's shelter-in-place pandemic order. They've provided [an interactive map here](https://www1.nyc.gov/assets/buildings/html/essential-active-construction.html) where you can see the different projects. There's also a link there to download the complete dataset.

For this exercise, you're going to use this data to visualize the amounts or proportions of different types of essential projects in the five boroughs of New York City (Brooklyn, Manhattan, the Bronx, Queens, and Staten Island).

As you hopefully figured out by now, you'll be doing all your `R` work in `R Markdown`. You can use an RStudio Project to keep your files well organized (either on your computer or on RStudio.cloud), but this is optional. If you decide to do so, either create a new project for this exercise only, or make a project for all your work in this class.

You'll need to download one CSV file and put it somewhere on your computer or upload it to RStudio.cloud---preferably in a folder named `data` in your project folder. You can download the data from [the DOB's map](https://www1.nyc.gov/assets/buildings/html/essential-active-construction.html), or use this link to get it directly:

- [<i class="fas fa-file-csv"></i> `EssentialConstruction.csv`](/data/EssentialConstruction.csv)




### R Markdown

Writing regular text with `R Markdown` follows the rules of Markdown. You can make lists; different-size headers, etc. This should be relatively straightfoward. We talked about a few Markdown features like **bold** and *italics* in class. See [this resource for more formatting](https://ssc442kirkpatrick.netlify.app/resource/).

You'll also need to insert your own code chunks where needed. Rather than typing them by hand (that's tedious and you might miscount the number of backticks!), use the "Insert" button at the top of the editing window, or type <kbd>ctrl</kbd> + <kbd>alt</kbd> + <kbd>i</kbd> on Windows, or <kbd>⌘</kbd> + <kbd>⌥</kbd> + <kbd>i</kbd> on macOS.

```{r insert-chunk-button, echo=FALSE, out.width="19%"}
knitr::include_graphics("/img/assignments/insert-chunk-button.png", error = FALSE)
```


```{r eval=T, include=F, echo=F}
library(tidyverse)
essentialConstruction = read_csv('./data/EssentialConstruction.csv')
```

### Data Prep
Once you download the `EssentialConstruction.csv` file and save it in your project folder, you can open it and start cleaning. I'll help with that. 

In class, we used base-R's `read.csv`. `tidyverse` has its own `read_csv` function that is a bit more robust. Let's use that. Make a *new* code chunk and use it to import and clean the data:

- Use `essentialConstruction <- read_csv('path/to/the/downloaded/EssentialConstruction.csv')`. This will import your data. You can then look at it to see the variables. Use `str(essentialConstruction)` to see the data types.

- One of the columns has a name that has a space in it. Things get awkward when this happens. Let's `mutate` a new column. When we want to refer to a column name with a space in it, we have to wrap it in the backtick \`.

```{r CleanData-1, eval=T, echo=T}
essentialConstruction = essentialConstruction %>%
  mutate(JOBNUMBERS = `JOB NUMBERS`)
```



:::fyi
__Exercise 1 of 1: Essential pandemic construction__

A. **Create a variable**: Using `case_when` and `mutate`, create a new variable called `APPROVED` which is equal to `TRUE` when `JOBNUMBERS` is "All jobs for this BIN are approved", and is equal to `FALSE` otherwise. 

**Make the following plots and briefly explain what they show.**

B. Show the count or proportion of approved projects by borough using a bar chart.

C. Show the count or proportion of approved projects by category using a lollipop chart. Not sure of what a lollipop chart is? Google `R ggplot lollipop`. A huge portion of knowing how to code is knowing how to google, find examples, and figure out where to put your variables from your data!

D. Show the proportion of approved projects by borough and category *simultaneously* using a heatmap.

You don't need to make these super fancy, but if you're feeling brave, experiment with adding a `labs()` layer or changing fill colors with `scale_fill_manual()` or with palettes.

__Bonus__

Overlay the data from Part 1 above onto a map of NYC. For double bonus, color the boroughs.

:::

## Getting help

Use the SSC442 Slack if you get stuck (click the Slack logo at the top right of this website header).

## Turning everything in

When you're all done, click on the "Knit" button at the top of the editing window and create a PDF. Upload the PDF file to D2L.
